# ============================================================================
# AgentHub Multi-Tenant Chatbot - Configuration Template
# ============================================================================
#
# SETUP INSTRUCTIONS:
# 1. Copy this file to .env: cp .env.example .env
# 2. Replace all placeholder values with your actual configuration
# 3. Generate FERNET_KEY: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# 4. Never commit .env to version control (already in .gitignore)
#
# DOCUMENTATION: See backend/Guides/CONFIGURATION.md for detailed explanation
#
# ============================================================================

# ----------------------------------------------------------------------------
# Database Configuration (PostgreSQL 15+ with pgvector)
# ----------------------------------------------------------------------------
# Required: PostgreSQL connection string
# Format: postgresql://[user]:[password]@[host]:[port]/[database]
DATABASE_URL=postgresql://postgres:CHANGE_THIS_PASSWORD@localhost:5432/chatbot_itl

# Database connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10

# Docker Compose Database Settings (used by docker-compose.yml)
DB_NAME=chatbot_itl
DB_USER=postgres
DB_PASSWORD=CHANGE_THIS_PASSWORD
DB_PORT=5432

# ----------------------------------------------------------------------------
# Redis Configuration (Caching & Rate Limiting)
# ----------------------------------------------------------------------------
# Required: Redis connection URL
REDIS_URL=redis://localhost:6379

# Cache time-to-live in seconds (default: 1 hour)
CACHE_TTL_SECONDS=3600

# Docker Compose Redis Settings
REDIS_PORT=6379

# ----------------------------------------------------------------------------
# Security - Encryption & Authentication
# ----------------------------------------------------------------------------

# Fernet Key (REQUIRED - for encrypting tenant API keys in database)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# SECURITY: Keep this secret! If lost, encrypted API keys become unrecoverable.
FERNET_KEY=kN8j3xP5mR7qT9wV2yB4nL6oC1eH3fA8gD0iK5sU9jM=

# JWT Public Key (Required if DISABLE_AUTH=false)
# RS256 public key for verifying JWT tokens from auth service
# Multi-line format (paste entire public key including BEGIN/END markers):
JWT_PUBLIC_KEY=

# Auth Bypass Toggle (DEVELOPMENT ONLY - never true in production)
# When true: bypasses JWT auth, uses test tenant ID
# When false: requires JWT token in Authorization header
# SECURITY: Config validator will prevent DISABLE_AUTH=true in production
DISABLE_AUTH=true

# Test Bearer Token (optional, for development)
# Used by HTTP tool when calling external APIs in dev mode with DISABLE_AUTH=true
TEST_BEARER_TOKEN=

# ----------------------------------------------------------------------------
# Application Settings
# ----------------------------------------------------------------------------

# Environment (development, staging, production)
# IMPORTANT: Controls auth bypass validation, SQL logging, error verbosity
ENVIRONMENT=development

# Logging Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# API Server Binding
API_HOST=0.0.0.0
API_PORT=8000

# ----------------------------------------------------------------------------
# CORS Configuration
# ----------------------------------------------------------------------------
# Comma-separated list of allowed origins for cross-origin requests
# Development: Allow localhost origins
# Production: Only allow specific domains (never use *)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080

# ----------------------------------------------------------------------------
# Rate Limiting (Defaults for new tenants)
# ----------------------------------------------------------------------------
# Requests per minute (per tenant)
DEFAULT_RATE_LIMIT_RPM=60

# Tokens per minute (per tenant)
DEFAULT_RATE_LIMIT_TPM=10000

# ----------------------------------------------------------------------------
# LLM Provider Configuration
# ----------------------------------------------------------------------------

# OpenRouter API Key (optional - only if using OpenRouter)
# Get your key at: https://openrouter.ai/keys
OPENROUTER_API_KEY=

# OpenRouter Base URL (rarely needs changing)
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1

# ----------------------------------------------------------------------------
# Docker Compose - Optional Admin Tools
# ----------------------------------------------------------------------------
# These are only used when running: docker-compose --profile admin up

# pgAdmin (PostgreSQL Web UI)
PGADMIN_EMAIL=admin@agenthub.local
PGADMIN_PASSWORD=CHANGE_THIS_PASSWORD
PGADMIN_PORT=5050

# Redis Commander (Redis Web UI)
REDIS_COMMANDER_PORT=8081

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================
#
# Before deploying to production, verify:
#
# [CRITICAL]
# [ ] FERNET_KEY is set to a unique, strong key (not the example)
# [ ] DATABASE_URL uses a strong password (not default postgres/123456)
# [ ] DISABLE_AUTH=false (never true in production)
# [ ] ENVIRONMENT=production
# [ ] JWT_PUBLIC_KEY is configured (if using JWT auth)
#
# [SECURITY]
# [ ] .env file is NOT committed to git (check .gitignore)
# [ ] All passwords are unique and strong (20+ characters)
# [ ] CORS_ORIGINS only includes production domains
# [ ] Database user has minimum required permissions
#
# [PERFORMANCE]
# [ ] DB_POOL_SIZE tuned for expected load (default: 20)
# [ ] CACHE_TTL_SECONDS appropriate for your data freshness needs
# [ ] Redis persistence enabled (AOF or RDB)
#
# [MONITORING]
# [ ] LOG_LEVEL set to WARNING or ERROR (not DEBUG)
# [ ] Error tracking configured (Sentry, etc.)
# [ ] Metrics collection enabled (Prometheus, etc.)
#
# See: backend/Guides/BACKEND_SETUP.md for production deployment guide
# See: CHANGELOG_FIXES.md for known issues and fixes
#
# ============================================================================

# ============================================================================
# QUICK START GUIDE
# ============================================================================
#
# 1. Install dependencies:
#    cd backend
#    python -m venv venv
#    venv\Scripts\activate  # Windows
#    pip install -r requirements.txt
#
# 2. Start PostgreSQL + Redis:
#    docker-compose up -d
#
# 3. Run migrations:
#    alembic upgrade head
#
# 4. Start backend:
#    python src/main.py
#
# 5. Access API docs:
#    http://localhost:8000/docs
#
# For detailed setup instructions, see: backend/Guides/BACKEND_SETUP.md
#
# ============================================================================
